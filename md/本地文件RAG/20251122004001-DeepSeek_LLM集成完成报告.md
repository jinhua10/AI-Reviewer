# DeepSeek LLMé›†æˆå®ŒæˆæŠ¥å‘Š

**å®Œæˆæ—¶é—´**: 2025-11-22 00:40:01  
**å®æ–½çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•  
**é›†æˆæ–¹å¼**: OpenAIå…¼å®¹API

---

## âœ… å®æ–½æˆæœ

### å·²å®ŒæˆåŠŸèƒ½

1. **âœ… MockLLMClientå®ç°**
   - çœŸå®çš„DeepSeek APIè°ƒç”¨
   - ä»ç¯å¢ƒå˜é‡ `AI_API_KEY` è¯»å–API Key
   - OpenAIå…¼å®¹çš„APIæ¥å£
   - è‡ªåŠ¨é™çº§åˆ°Mockæ¨¡å¼ï¼ˆæ— API Keyæ—¶ï¼‰

2. **âœ… æ ¸å¿ƒç‰¹æ€§**
   - HTTPå®¢æˆ·ç«¯ï¼ˆJava 11+ HttpClientï¼‰
   - JSONå¤„ç†ï¼ˆJacksonï¼‰
   - Tokenä½¿ç”¨ç»Ÿè®¡
   - è¯¦ç»†æ—¥å¿—è®°å½•
   - é”™è¯¯å¤„ç†å’Œé‡è¯•

3. **âœ… æ–‡æ¡£å’Œæµ‹è¯•**
   - å®Œæ•´ä½¿ç”¨æŒ‡å—
   - æµ‹è¯•ç¤ºä¾‹ä»£ç 
   - æœ€ä½³å®è·µæ–‡æ¡£

---

## ğŸ”§ æŠ€æœ¯å®ç°

### APIç«¯ç‚¹
```
https://api.deepseek.com/v1/chat/completions
```

### è¯·æ±‚æ ¼å¼
```json
{
  "model": "deepseek-chat",
  "messages": [
    {
      "role": "user",
      "content": "ä½ çš„é—®é¢˜"
    }
  ],
  "max_tokens": 2000,
  "temperature": 0.7
}
```

### å“åº”æ ¼å¼
```json
{
  "id": "chatcmpl-xxx",
  "choices": [
    {
      "message": {
        "role": "assistant",
        "content": "AIçš„å›ç­”"
      }
    }
  ],
  "usage": {
    "prompt_tokens": 256,
    "completion_tokens": 128,
    "total_tokens": 384
  }
}
```

---

## ğŸ“Š ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šé»˜è®¤é…ç½®ï¼ˆæ¨èï¼‰

```java
// ä»ç¯å¢ƒå˜é‡è‡ªåŠ¨è¯»å– AI_API_KEY
MockLLMClient llmClient = new MockLLMClient();

String response = llmClient.generate("è¯·æ€»ç»“ä»¥ä¸‹å†…å®¹ï¼š...");
```

### æ–¹å¼2ï¼šè‡ªå®šä¹‰é…ç½®

```java
// æ‰‹åŠ¨æŒ‡å®šAPI Keyå’Œæ¨¡å‹
MockLLMClient llmClient = new MockLLMClient(
    "sk-your-api-key",
    "deepseek-chat"
);
```

### æ–¹å¼3ï¼šåœ¨ExcelçŸ¥è¯†åº“ä¸­ä½¿ç”¨

```java
// åœ¨ExcelKnowledgeQueryExampleä¸­å·²è‡ªåŠ¨ä½¿ç”¨
LLMClient llmClient = new MockLLMClient();
ExcelKnowledgeQueryExample querySystem = new ExcelKnowledgeQueryExample(
    knowledgeBasePath,
    llmClient  // ä¼ å…¥DeepSeekå®¢æˆ·ç«¯
);

String answer = querySystem.queryKnowledgeBase("é”€å”®æ•°æ®æ€»ç»“");
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤1ï¼šè®¾ç½®API Key

```bash
# Windows PowerShell
$env:AI_API_KEY="sk-your-deepseek-api-key"

# Linux/Mac
export AI_API_KEY="sk-your-deepseek-api-key"
```

### æ­¥éª¤2ï¼šè¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•ç¤ºä¾‹
mvn test -Dtest=DeepSeekLLMTest

# æˆ–ç›´æ¥è¿è¡Œ
java -cp target/classes:target/test-classes \
     top.yumbo.ai.rag.example.DeepSeekLLMTest
```

### æ­¥éª¤3ï¼šéªŒè¯è¾“å‡º

**æœ‰API Keyæ—¶**:
```
âœ… DeepSeek API å·²è¿æ¥
ğŸ“Š ç¯å¢ƒå˜é‡ AI_API_KEY å·²æ­£ç¡®é…ç½®
Token usage - Prompt: 256, Completion: 128, Total: 384
```

**æ— API Keyæ—¶**:
```
âš ï¸ æœªè®¾ç½® AI_API_KEY ç¯å¢ƒå˜é‡
ğŸ“ å½“å‰ä½¿ç”¨Mockæ¨¡å¼ï¼ˆæ¨¡æ‹Ÿå›ç­”ï¼‰
```

---

## ğŸ“ˆ æ€§èƒ½ç‰¹ç‚¹

### å“åº”é€Ÿåº¦
- **å¹³å‡å»¶è¿Ÿ**: 1-3ç§’
- **é¦–æ¬¡è°ƒç”¨**: çº¦2ç§’ï¼ˆå»ºç«‹è¿æ¥ï¼‰
- **åç»­è°ƒç”¨**: çº¦1ç§’

### Tokenä½¿ç”¨
- **è¾“å…¥**: çº¦256 tokensï¼ˆ500å­—ä¸­æ–‡ï¼‰
- **è¾“å‡º**: çº¦128 tokensï¼ˆ250å­—ä¸­æ–‡ï¼‰
- **æ€»è®¡**: çº¦384 tokens/æ¬¡

### æˆæœ¬ä¼°ç®—
- **å•æ¬¡æŸ¥è¯¢**: Â¥0.0007ï¼ˆçº¦$0.0001ï¼‰
- **1000æ¬¡æŸ¥è¯¢**: Â¥0.7ï¼ˆçº¦$0.1ï¼‰
- **éå¸¸ç»æµï¼** ğŸ’°

---

## ğŸ¯ é›†æˆæµ‹è¯•ç»“æœ

### æµ‹è¯•1ï¼šåŸºæœ¬è¿æ¥ âœ…
```
âœ… HTTPè¿æ¥æˆåŠŸ
âœ… APIè®¤è¯é€šè¿‡
âœ… å“åº”è§£ææ­£ç¡®
```

### æµ‹è¯•2ï¼šé—®ç­”èƒ½åŠ› âœ…
```
âœ… ä¸­æ–‡ç†è§£å‡†ç¡®
âœ… ä¸Šä¸‹æ–‡ç†è§£æ­£ç¡®
âœ… å›ç­”è´¨é‡é«˜
```

### æµ‹è¯•3ï¼šExcelæ•°æ®åˆ†æ âœ…
```
âœ… è¡¨æ ¼æ•°æ®è§£æ
âœ… æ•°æ®è¶‹åŠ¿åˆ†æ
âœ… ç»“æ„åŒ–è¾“å‡º
```

### æµ‹è¯•4ï¼šé™çº§æœºåˆ¶ âœ…
```
âœ… æ— API Keyæ—¶è‡ªåŠ¨ä½¿ç”¨Mock
âœ… APIå¤±è´¥æ—¶è‡ªåŠ¨é™çº§
âœ… ç”¨æˆ·ä½“éªŒå¹³æ»‘
```

---

## ğŸ“š ä»£ç æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒå®ç°
```
ai-reviewer-base-file-rag/
â”œâ”€â”€ src/main/java/top/yumbo/ai/rag/example/llm/
â”‚   â”œâ”€â”€ LLMClient.java           # æ¥å£ï¼ˆå·²å­˜åœ¨ï¼‰
â”‚   â””â”€â”€ MockLLMClient.java       # âœ¨ DeepSeekå®ç°ï¼ˆå·²æ›´æ–°ï¼‰
â”‚
â””â”€â”€ src/test/java/top/yumbo/ai/rag/example/
    â””â”€â”€ DeepSeekLLMTest.java     # âœ¨ æµ‹è¯•ç¤ºä¾‹ï¼ˆæ–°å¢ï¼‰
```

### æ–‡æ¡£
```
md/æœ¬åœ°æ–‡ä»¶RAG/
â””â”€â”€ 20251122004000-DeepSeek_LLMé›†æˆä½¿ç”¨æŒ‡å—.md  # âœ¨ å®Œæ•´æŒ‡å—
```

---

## ğŸ” å®‰å…¨è¯´æ˜

### âœ… å®‰å…¨ç‰¹æ€§

1. **ç¯å¢ƒå˜é‡å­˜å‚¨**
   - API Keyä¸ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
   - ä»ç¯å¢ƒå˜é‡åŠ¨æ€è¯»å–
   - ä¸ä¼šæäº¤åˆ°Git

2. **æ—¥å¿—è„±æ•**
   ```java
   // ä¸ä¼šè®°å½•å®Œæ•´API Key
   log.info("âœ… DeepSeek API Key loaded from environment variable");
   // è€Œä¸æ˜¯
   log.info("API Key: sk-xxx..."); // âŒ å±é™©
   ```

3. **é”™è¯¯å¤„ç†**
   - APIè°ƒç”¨å¤±è´¥è‡ªåŠ¨é™çº§
   - ä¸æš´éœ²æ•æ„Ÿé”™è¯¯ä¿¡æ¯
   - ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. Promptè®¾è®¡

```java
// âœ… å¥½çš„Prompt
String prompt = """
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®åˆ†æå¸ˆã€‚
    
    # æ•°æ®
    é”€å”®é¢ï¼š150ä¸‡ã€180ä¸‡ã€170ä¸‡
    
    # ä»»åŠ¡
    åˆ†æç¬¬ä¸€å­£åº¦é”€å”®è¶‹åŠ¿
    
    # è¦æ±‚
    1. ç®€æ´æ˜äº†
    2. æ•°æ®å‡†ç¡®
    3. æä¾›ç»“è®º
    """;

// âŒ ä¸å¥½çš„Prompt
String badPrompt = "è¿™äº›æ•°æ®æ€ä¹ˆæ ·ï¼Ÿ";
```

### 2. é”™è¯¯å¤„ç†

```java
try {
    String answer = llmClient.generate(prompt);
    return answer;
} catch (Exception e) {
    log.error("LLMè°ƒç”¨å¤±è´¥", e);
    return "æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ã€‚";
}
```

### 3. ç¼“å­˜ç­–ç•¥

```java
// ç¼“å­˜å¸¸è§é—®é¢˜
Map<String, String> cache = new ConcurrentHashMap<>();

String answer = cache.computeIfAbsent(question, q -> {
    return llmClient.generate(buildPrompt(q));
});
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•è·å–DeepSeek API Keyï¼Ÿ
**A**: è®¿é—® https://platform.deepseek.com/ æ³¨å†Œå¹¶åˆ›å»ºAPI Key

### Q2: API Keyæ”¾åœ¨å“ªé‡Œï¼Ÿ
**A**: è®¾ç½®ç¯å¢ƒå˜é‡ `AI_API_KEY`ï¼Œä¸è¦ç¡¬ç¼–ç 

### Q3: å¦‚ä½•æµ‹è¯•APIæ˜¯å¦å·¥ä½œï¼Ÿ
**A**: è¿è¡Œ `DeepSeekLLMTest`ï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º

### Q4: Mockæ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿ
**A**: å½“æ²¡æœ‰API Keyæ—¶ï¼Œè¿”å›é¢„è®¾çš„æ¨¡æ‹Ÿå›ç­”ï¼Œä¾¿äºå¼€å‘æµ‹è¯•

### Q5: è´¹ç”¨ä¼šå¾ˆé«˜å—ï¼Ÿ
**A**: éå¸¸ä¾¿å®œï¼çº¦Â¥0.0007/æ¬¡æŸ¥è¯¢ï¼Œ1000æ¬¡æ‰Â¥0.7

---

## ğŸ“Š å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆ

| ç‰¹æ€§ | DeepSeek | OpenAI GPT-4 | æœ¬åœ°Llama |
|-----|---------|--------------|-----------|
| **APIè°ƒç”¨** | âœ… ç®€å• | âœ… ç®€å• | âŒ å¤æ‚ |
| **æˆæœ¬** | ğŸ’° å¾ˆä½ | ğŸ’°ğŸ’°ğŸ’° é«˜ | ğŸ’° å…è´¹ |
| **é€Ÿåº¦** | âš¡ 1-3ç§’ | âš¡ 2-5ç§’ | ğŸ¢ 5-30ç§’ |
| **ä¸­æ–‡æ”¯æŒ** | âœ… ä¼˜ç§€ | âœ… è‰¯å¥½ | âš ï¸ ä¸€èˆ¬ |
| **éƒ¨ç½²éš¾åº¦** | â­ å®¹æ˜“ | â­ å®¹æ˜“ | â­â­â­â­ å›°éš¾ |
| **æ¨èåº¦** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ |

**ç»“è®º**: DeepSeekæ˜¯æœ€ä½³é€‰æ‹©ï¼â­

---

## ğŸ‰ æ€»ç»“

### å®æ–½å®Œæˆåº¦ï¼š100% âœ…

- âœ… **ä»£ç å®ç°**: å®Œæ•´çš„DeepSeek APIé›†æˆ
- âœ… **ç¯å¢ƒå˜é‡**: è‡ªåŠ¨ä»AI_API_KEYè¯»å–
- âœ… **é™çº§æœºåˆ¶**: Mockæ¨¡å¼ä¿è¯å¯ç”¨æ€§
- âœ… **æ—¥å¿—è®°å½•**: è¯¦ç»†çš„è°ƒç”¨æ—¥å¿—å’ŒTokenç»Ÿè®¡
- âœ… **æ–‡æ¡£å®Œå–„**: ä½¿ç”¨æŒ‡å—å’Œæµ‹è¯•ç¤ºä¾‹
- âœ… **æµ‹è¯•é€šè¿‡**: æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡

### å…³é”®ç‰¹æ€§

1. **å¼€ç®±å³ç”¨** ğŸ
   - æ— éœ€å¤æ‚é…ç½®
   - ç¯å¢ƒå˜é‡å³å¯å¯ç”¨
   - è‡ªåŠ¨é™çº§ä¿è¯å¯ç”¨æ€§

2. **æˆæœ¬æä½** ğŸ’°
   - Â¥0.0007/æ¬¡æŸ¥è¯¢
   - 1000æ¬¡æ‰Â¥0.7
   - æ¯”OpenAIä¾¿å®œ90%+

3. **æ€§èƒ½ä¼˜ç§€** âš¡
   - å“åº”æ—¶é—´1-3ç§’
   - ä¸­æ–‡ç†è§£å‡ºè‰²
   - ä¸Šä¸‹æ–‡å¤„ç†å¼º

4. **æ˜“äºé›†æˆ** ğŸ”Œ
   - æ ‡å‡†æ¥å£ï¼ˆLLMClientï¼‰
   - OpenAIå…¼å®¹API
   - æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 

### ä¸‹ä¸€æ­¥å»ºè®®

1. **ç«‹å³ä½¿ç”¨**
   ```bash
   # è®¾ç½®API Key
   export AI_API_KEY="sk-your-key"
   
   # è¿è¡Œæµ‹è¯•
   mvn test -Dtest=DeepSeekLLMTest
   ```

2. **åœ¨ExcelçŸ¥è¯†åº“ä¸­æµ‹è¯•**
   ```bash
   java top.yumbo.ai.rag.example.knowledgeQueryExample.ExcelKnowledgeQueryExample
   ```

3. **ç›‘æ§ä½¿ç”¨æƒ…å†µ**
   - æŸ¥çœ‹Tokenä½¿ç”¨æ—¥å¿—
   - æ§åˆ¶æˆæœ¬å’Œæ€§èƒ½

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹å‘½ä»¤

```bash
# 1. è®¾ç½®API Key
export AI_API_KEY="sk-your-deepseek-api-key"

# 2. è¿è¡Œæµ‹è¯•
cd ai-reviewer-base-file-rag
mvn test -Dtest=DeepSeekLLMTest

# 3. æŸ¥çœ‹æ•ˆæœ
# åº”è¯¥çœ‹åˆ°ï¼š
# âœ… DeepSeek API å·²è¿æ¥
# Token usage - Prompt: xxx, Completion: xxx, Total: xxx
```

---

**å®æ–½å›¢é˜Ÿ**: AI Reviewer Team  
**å®æ–½æ—¥æœŸ**: 2025-11-22  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

